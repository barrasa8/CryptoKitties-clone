{"ast":null,"code":"var _jsxFileName = \"/home/ismael/Documents/Projects/GIT/CryptoKitties-clone/client/src/components/PandaDetail.jsx\";\nimport React, { Component } from 'react';\nimport { Container, Row, Button, InputGroup, FormControl, Badge } from \"react-bootstrap\";\nimport PandaCard from \"./PandaCard\";\nimport { epochToUTCDate, getPanda, setOffer, removeOffer, getOffer, setApprovalForAll, buyPanda } from \"../assets/js/utils\";\nimport \"../assets/css/pandaDetail.css\";\n\nclass PandaDetail extends Component {\n  constructor() {\n    super();\n\n    this.handleSubmit = async event => {\n      event.preventDefault();\n\n      if (this.state.offer === undefined) {\n        await setOffer(this.props.marketContract, this.props.accounts, this.props.web3.utils.toWei(String(this.state.amount)), this.props.match.params.id);\n      } else if (this.props.accounts[0] === this.state.offer.seller) {\n        await removeOffer(this.props.marketContract, this.props.accounts, this.props.match.params.id);\n      } else {\n        await buyPanda(this.props.marketContract, this.props.accounts, this.props.match.params.id, this.state.offer.price);\n      }\n    };\n\n    this.handleChange = event => {\n      event.preventDefault();\n      event.persist();\n      this.setState(() => ({\n        [event.target.name]: parseInt(event.target.value)\n      }));\n    };\n\n    this.handleRemove = async event => {\n      event.preventDefault();\n      await removeOffer(this.props.marketContract, this.props.accounts, this.props.match.params.id);\n    };\n\n    this._setApprovalForAll = async () => {\n      let _isApprovedForAll;\n\n      setApprovalForAll(this.props.contract, this.props.marketContract, this.props.accounts, true);\n      _isApprovedForAll = await this.props.contract.methods.isApprovedForAll(this.props.accounts[0], this.props.marketContract.options.address).call();\n      this.setState(() => ({\n        IsMarketOpperator: _isApprovedForAll\n      }));\n    };\n\n    this.state = {\n      pandaItem: null,\n      amount: 0,\n      offer: {\n        seller: \"\",\n        price: 0,\n        index: 0,\n        tokenId: 0,\n        active: false\n      },\n      pandaOwner: 0,\n      IsMarketOpperator: false\n    };\n  }\n\n  async componentDidMount() {\n    let _pandaItem, _offer, _ownerOf, _isApprovedForAll;\n\n    try {\n      _isApprovedForAll = await this.props.contract.methods.isApprovedForAll(this.props.accounts[0], this.props.marketContract.options.address).call();\n      this.setState(() => ({\n        IsMarketOpperator: _isApprovedForAll\n      }));\n    } catch (e) {\n      console.log(\"Not approved for all\", e);\n    }\n\n    try {\n      _pandaItem = await getPanda(this.props.contract, this.props.accounts, this.props.match.params.id);\n    } catch (e) {\n      console.log(\"No Pandas\");\n    }\n\n    try {\n      _offer = await getOffer(this.props.marketContract, this.props.accounts, this.props.match.params.id);\n\n      if (_offer.active === false) {\n        _offer = undefined;\n      }\n    } catch (e) {\n      console.log(\"No offer\");\n    }\n\n    try {\n      _ownerOf = await this.props.contract.methods.ownerOf(this.props.match.params.id).call({\n        from: this.props.accounts[0]\n      });\n    } catch (e) {\n      console.log(\"Error: executing OwnerOf\");\n    }\n\n    this.setState(() => ({\n      pandaItem: _pandaItem,\n      offer: _offer,\n      pandaOwner: _ownerOf\n    }));\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-content-md-center body-title body-title-font\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }\n    }, \"Set your offer\")), this.state.pandaItem != null ? /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-content-md-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(PandaCard, {\n      key: \"panda-card-\" + this.state.pandaItem.pandaTokenId.toString(),\n      dna: this.state.pandaItem.dna,\n      mumId: this.state.pandaItem.mumId,\n      dadId: this.state.pandaItem.dadId,\n      generation: this.state.pandaItem.generation,\n      birthTime: epochToUTCDate(this.state.pandaItem.birthTime),\n      className: \"cursor-pointer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"space-between-elements\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 25\n      }\n    }, this.state.offer !== undefined ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Badge, {\n      variant: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 37\n      }\n    }, \"Owner: \", this.state.offer.seller)), /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Badge, {\n      variant: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 37\n      }\n    }, \"Price: \", this.props.web3.utils.fromWei(String(this.state.offer.price), 'ether'), \" ETH\"))) : \"\", this.state.IsMarketOpperator === false & this.state.pandaOwner == this.props.accounts[0] ? /*#__PURE__*/React.createElement(Button, {\n      id: \"btn-permissions\",\n      onClick: this._setApprovalForAll,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 41\n      }\n    }, \"Delegate Operator rights\") : \"\", /*#__PURE__*/React.createElement(\"form\", {\n      id: \"panda-detail-offer\",\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 29\n      }\n    }, this.state.offer == undefined ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 37\n      }\n    }, this.state.pandaOwner == this.props.accounts[0] ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(InputGroup, {\n      className: \"mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(FormControl, {\n      \"aria-label\": \"Amount\",\n      name: \"amount\",\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 49\n      }\n    }), /*#__PURE__*/React.createElement(InputGroup.Append, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(InputGroup.Text, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 53\n      }\n    }, \"ETH\"))), /*#__PURE__*/React.createElement(Button, {\n      variant: \"success\",\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 45\n      }\n    }, \"Sell\")) : \"\") : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"space-between-elements\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 41\n      }\n    }), this.props.accounts[0] == this.state.offer.seller ? /*#__PURE__*/React.createElement(Button, {\n      variant: \"danger\",\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 41\n      }\n    }, \"Remove Offer\") : /*#__PURE__*/React.createElement(Button, {\n      variant: \"success\",\n      type: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 41\n      }\n    }, \"Buy Me\"))))) : \"\");\n  }\n\n}\n\nexport default PandaDetail;","map":{"version":3,"sources":["/home/ismael/Documents/Projects/GIT/CryptoKitties-clone/client/src/components/PandaDetail.jsx"],"names":["React","Component","Container","Row","Button","InputGroup","FormControl","Badge","PandaCard","epochToUTCDate","getPanda","setOffer","removeOffer","getOffer","setApprovalForAll","buyPanda","PandaDetail","constructor","handleSubmit","event","preventDefault","state","offer","undefined","props","marketContract","accounts","web3","utils","toWei","String","amount","match","params","id","seller","price","handleChange","persist","setState","target","name","parseInt","value","handleRemove","_setApprovalForAll","_isApprovedForAll","contract","methods","isApprovedForAll","options","address","call","IsMarketOpperator","pandaItem","index","tokenId","active","pandaOwner","componentDidMount","_pandaItem","_offer","_ownerOf","e","console","log","ownerOf","from","render","pandaTokenId","toString","dna","mumId","dadId","generation","birthTime","fromWei"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Container, Row ,Button, InputGroup,FormControl, Badge} from \"react-bootstrap\";\nimport PandaCard from \"./PandaCard\";\nimport {epochToUTCDate ,getPanda, setOffer, removeOffer,getOffer, setApprovalForAll , buyPanda} from \"../assets/js/utils\";\nimport \"../assets/css/pandaDetail.css\";\n\nclass PandaDetail extends Component {\n\n    constructor() {\n        super();\n        this.state = {\n            pandaItem:null,\n            amount:0,\n            offer:{\n                seller: \"\",\n                price: 0, \n                index: 0, \n                tokenId: 0, \n                active: false\n            },\n            pandaOwner:0,\n            IsMarketOpperator:false\n        };\n    }\n\n    async componentDidMount(){\n        let _pandaItem,_offer,_ownerOf,_isApprovedForAll;\n\n        try{\n            _isApprovedForAll = await this.props.contract.methods.isApprovedForAll(this.props.accounts[0],this.props.marketContract.options.address).call();\n            this.setState(() => ({\n              IsMarketOpperator: _isApprovedForAll   \n            }));\n          } catch(e){\n            console.log(\"Not approved for all\",e);\n          }\n\n        try{\n            _pandaItem = await getPanda(this.props.contract, this.props.accounts,this.props.match.params.id);\n        } catch(e){\n            console.log(\"No Pandas\");\n        }\n        \n        try{\n            _offer = await getOffer(this.props.marketContract, this.props.accounts,this.props.match.params.id);\n            if(_offer.active===false){\n                _offer = undefined;\n            }\n        } catch(e){\n            console.log(\"No offer\");\n        }\n\n        try{\n            _ownerOf=await this.props.contract.methods.ownerOf(this.props.match.params.id).call({ from: this.props.accounts[0] }); \n        } catch(e){\n            console.log(\"Error: executing OwnerOf\");\n        }\n\n        this.setState(() => ({\n            pandaItem: _pandaItem,\n            offer: _offer,\n            pandaOwner: _ownerOf\n          }));\n    }\n\n    handleSubmit= async (event) => {\n        event.preventDefault();\n        if(this.state.offer===undefined){\n            await setOffer(this.props.marketContract, this.props.accounts,this.props.web3.utils.toWei(String(this.state.amount)),this.props.match.params.id);\n        }else if(this.props.accounts[0]===this.state.offer.seller){\n            await removeOffer(this.props.marketContract, this.props.accounts,this.props.match.params.id);\n        }else{ \n            await buyPanda(this.props.marketContract, this.props.accounts,this.props.match.params.id,this.state.offer.price);\n        }       \n    }\n\n    handleChange= (event) => {\n        event.preventDefault();\n        event.persist();\n        this.setState(() => ({\n            [event.target.name]: parseInt(event.target.value)\n          }));\n    }\n\n    handleRemove =  async (event) =>{\n        event.preventDefault();\n        await removeOffer(this.props.marketContract, this.props.accounts,this.props.match.params.id);\n    }\n\n    _setApprovalForAll =  async ()=>  {\n        let _isApprovedForAll;\n        \n        setApprovalForAll(this.props.contract,this.props.marketContract,this.props.accounts,true);\n       \n        _isApprovedForAll = await this.props.contract.methods.isApprovedForAll(this.props.accounts[0],this.props.marketContract.options.address).call();\n       \n        this.setState(() => ({\n          IsMarketOpperator: _isApprovedForAll\n        }));\n    }\n\n    render() { \n        return (  \n            <Container fluid>\n                <Row className=\"justify-content-md-center body-title body-title-font\">\n                    <h1>Set your offer</h1>\n                </Row>\n                {this.state.pandaItem != null ?\n                    <Row className=\"justify-content-md-center\">\n                        <PandaCard\n                            key={\"panda-card-\" + this.state.pandaItem.pandaTokenId.toString()}\n                            dna={this.state.pandaItem.dna}\n                            mumId={this.state.pandaItem.mumId}\n                            dadId={this.state.pandaItem.dadId}\n                            generation={this.state.pandaItem.generation}\n                            birthTime={epochToUTCDate(this.state.pandaItem.birthTime)}\n                            className=\"cursor-pointer\"\n                        />\n                        <span className=\"space-between-elements\"/>\n                        <div>\n                            {this.state.offer !== undefined ?\n                            <div>\n                                <h4><Badge variant=\"secondary\">Owner: {this.state.offer.seller}</Badge></h4>\n                                <h4><Badge variant=\"secondary\">Price: {this.props.web3.utils.fromWei(String(this.state.offer.price), 'ether')} ETH</Badge></h4>\n                            </div>\n                            :\"\"}\n                            {this.state.IsMarketOpperator === false & this.state.pandaOwner ==this.props.accounts[0] ?\n                                        <Button id=\"btn-permissions\" onClick={this._setApprovalForAll}>Delegate Operator rights</Button>\n                            :\"\"}\n                            <form id=\"panda-detail-offer\" onSubmit={this.handleSubmit}>\n                                {this.state.offer == undefined ?\n                                    <div>\n                                        {this.state.pandaOwner ==this.props.accounts[0]?\n                                            <div>\n                                            <InputGroup className=\"mb-3\">\n                                                <FormControl aria-label=\"Amount\" name=\"amount\" onChange={this.handleChange}/>\n                                                <InputGroup.Append>\n                                                    <InputGroup.Text>ETH</InputGroup.Text>\n                                                </InputGroup.Append>\n                                            </InputGroup>\n                                            <Button variant=\"success\" type=\"submit\">Sell</Button>\n                                            </div>\n                                        :\"\"}\n                                    </div>   \n                                :\n                                    <div>\n                                        <span className=\"space-between-elements\"/>\n                                        {this.props.accounts[0]==this.state.offer.seller?\n                                        <Button variant=\"danger\" type=\"submit\">Remove Offer</Button>\n                                        :\n                                        <Button variant=\"success\" type=\"submit\">Buy Me</Button>\n                                        }\n                                    </div>\n                                }\n                            </form>\n                        </div>\n                    </Row>\n                :\"\"}\n            </Container>\n        );\n    }\n}\n \nexport default PandaDetail;\n"]},"metadata":{},"sourceType":"module"}